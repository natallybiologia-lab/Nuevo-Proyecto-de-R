---
title: "practica para final"
author: "Natally S. Vidal-Figueroa"
date: "2025-12-16"
output: html_document
---

```{r, warning=FALSE,message=FALSE}
library(palmerpenguins)
library(ggplot2)
library(dplyr)

```

```{r, echo=T}
data(package = 'palmerpenguins')
head(penguins)

```


# Dataset limpio (remueve filas con NA en variables clave)
#penguins_clean <- penguins %>%
 #drop_na(species, sex, island,
          #bill_length_mm, bill_depth_mm,
         # flipper_length_mm, body_mass_g)





Figura A: Boxplot de masa corporal por especie

```{r}
ggplot(penguins, aes(x = species, y = body_mass_g)) +
  geom_boxplot() +
  labs(x = "Especie", y = "Masa corporal (g)", title = "Masa corporal por especie") +
  theme_classic()

```

Figura B: Dispersión (aleta vs masa) con puntos sombreados y facetas por sexo

```{r}
ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(aes(fill = species), shape = 21, size = 3, alpha = 0.7, color = "black") +
  facet_wrap(~ sex) +
  labs(
    x = "Longitud de aleta (mm)",
    y = "Masa corporal (g)",
    title = "Relación aleta–masa por sexo",
    fill = "Especie"
  ) +
  theme_classic()

```

Figura C: Histograma de masa corporal por especie (facetas)

```{r}
ggplot(penguins, aes(x = body_mass_g)) +
  geom_histogram(bins = 25) +
  facet_wrap(~ species, scales = "free_y") +
  labs(x = "Masa corporal (g)", y = "Frecuencia", title = "Distribución de masa corporal por especie") +
  theme_classic()

```

Figura D: Densidad de longitud del pico por sexo (comparación visual)

```{r}
ggplot(penguins, aes(x = bill_length_mm, linetype = sex)) +
  geom_density(linewidth = 1) +
  labs(x = "Longitud del pico (mm)", y = "Densidad", title = "Densidad de longitud del pico por sexo",
       linetype = "Sexo") +
  theme_classic()

```

Figura E: Matriz simple (dos variables del pico) coloreada por especie.

```{r}
ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(fill = species), shape = 21, size = 3, alpha = 0.7, color = "black") +
  labs(
    x = "Longitud del pico (mm)",
    y = "Profundidad del pico (mm)",
    title = "Morfometría del pico por especie",
    fill = "Especie"
  ) +
  theme_classic()
```

Tablas descriptivas (por especie y sexo)

```{r}
tabla <- penguins%>%
  group_by(species, sex) %>%
  summarise(
    n = n(),
    mean_mass = mean(body_mass_g),
    sd_mass = sd(body_mass_g),
    mean_flipper = mean(flipper_length_mm),
    sd_flipper = sd(flipper_length_mm),
    .groups = "drop"
  )

tabla
```

t-test: masa corporal entre sexos (global)

```{r}
t.test(body_mass_g ~ sex, data = penguins)

```

t-test: masa corporal entre sexos SOLO para una especie (ej. Adelie)
```{r}
adelie <- penguins %>% filter(species == "Adelie")
t.test(body_mass_g ~ sex, data = adelie)
```

ANOVA 1-vía: masa corporal por especie
```{r}
anova1 <- aov(body_mass_g ~ species, data = penguins)
summary(anova1)

# Post hoc Tukey
TukeyHSD(anova1)
```

ANOVA 2-vías: masa corporal por especie + sexo (y su interacción)
```{r}
anova2 <- aov(body_mass_g ~ species * sex, data = penguins)
summary(anova2)

# Tukey para efectos principales (si procede)
TukeyHSD(anova2, which = "species")
TukeyHSD(anova2, which = "sex")

```

Chequeo de supuestos
```{r}
# Normalidad de residuos
shapiro.test(residuals(anova1))

# Homogeneidad de varianzas (Levene)
library(car)
leveneTest(body_mass_g ~ species, data = penguins)

```

Correlación (Pearson): aleta vs masa
```{r}
cor.test(penguins$flipper_length_mm, penguins$body_mass_g, method = "pearson")

```

Regresión lineal simple: masa ~ aleta

```{r}
lm1 <- lm(body_mass_g ~ flipper_length_mm, data = penguins)
summary(lm1)

```

Regresión múltiple: masa ~ aleta + pico + especie + sexo
```{r}
lm2 <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm + bill_depth_mm + species + sex,
          data = penguins)
summary(lm2)

```

